
<!doctype html><html lang="pt-BR"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Perfil — EnglishPlay</title><link rel="stylesheet" href="style.css"></head><body>
<header class="site-header"><div class="logo">EnglishPlay — Perfil</div></header>
<main class="container"><section class="card"><h2>Seu Perfil</h2>
<div style="display:flex;gap:14px;align-items:center"><img id="avatarImg" src="avatar-placeholder.png" class="profile-avatar"><div><input id="avatarInput" type="file" accept="image/*"><div style="margin-top:8px"><button id="saveBio" class="btn">Salvar</button></div></div></div>
<p><strong>Nome:</strong> <span id="u-name">—</span></p><p><strong>Email:</strong> <span id="u-email">—</span></p><p><strong>Idade:</strong> <span id="u-age">—</span></p><p><strong>Pontuação total:</strong> <span id="u-score">0</span></p><p><strong>Meta diária:</strong> <span id="u-target">—</span></p><p><strong>Streak:</strong> <span id="u-streak">0</span></p>
<h3>Comunidade</h3><div style="display:flex;gap:8px"><input id="searchName" class="input" placeholder="Pesquisar por nome"><button id="doSearch" class="btn">Buscar</button></div>
<div id="searchResults" style="margin-top:12px"></div>
<h3>Chat</h3><div class="chat-box" id="chatBox"></div><div style="display:flex;gap:8px;margin-top:8px"><input id="msgInput" class="input" placeholder="Escrever mensagem..."><button id="sendMsg" class="btn">Enviar</button></div>
<div style="margin-top:12px"><button id="logoutBtn" class="btn">Sair</button></div>
<p class="footer-note">Suporte: suporteenglishplay@gmail.com</p>
</section></main>
<script>
function getUsers(){ try{ return JSON.parse(localStorage.getItem('ep_users')||'[]') }catch(e){ return [] } }
function saveUsers(u){ localStorage.setItem('ep_users', JSON.stringify(u)) }
function getCurrent(){ return localStorage.getItem('ep_current') }
document.addEventListener('DOMContentLoaded', ()=>{ const email = getCurrent(); if(!email){ location.href='login.html'; return; } const users = getUsers(); const me = users.find(x=> x.email===email); if(me){ document.getElementById('u-name').textContent = me.name; document.getElementById('u-email').textContent = me.email; document.getElementById('u-age').textContent = me.age || '—'; document.getElementById('u-score').textContent = me.score || 0; document.getElementById('u-target').textContent = (me.target||'—') + ' dias'; document.getElementById('u-streak').textContent = me.streak || 0; if(me.avatar) document.getElementById('avatarImg').src = me.avatar; } document.getElementById('avatarInput').addEventListener('change', (e)=>{ const f = e.target.files[0]; if(!f) return; const r = new FileReader(); r.onload = ()=>{ document.getElementById('avatarImg').src = r.result; const users = getUsers(); const u = users.find(x=> x.email===email); if(u){ u.avatar = r.result; saveUsers(users); } }; r.readAsDataURL(f); }); document.getElementById('doSearch').addEventListener('click', ()=>{ const q = document.getElementById('searchName').value.trim().toLowerCase(); const users = getUsers(); const res = users.filter(x=> x.name.toLowerCase().includes(q)); const out = document.getElementById('searchResults'); out.innerHTML = ''; if(res.length===0){ out.textContent = 'Nenhum usuário encontrado'; return; } res.forEach(u=>{ const div = document.createElement('div'); div.style.display='flex'; div.style.alignItems='center'; div.style.gap='8px'; const img = document.createElement('img'); img.src = u.avatar || 'avatar-placeholder.png'; img.style.width='48px'; img.style.height='48px'; img.style.borderRadius='8px'; const txt = document.createElement('div'); txt.innerHTML = '<strong>'+u.name+'</strong><br><span class="small">'+(u.email||'')+'</span>'; const btn = document.createElement('button'); btn.className='btn'; btn.textContent = (me.friends && me.friends.includes(u.email))? 'Conversar' : 'Convidar amizade'; btn.addEventListener('click', ()=>{ if(me.email===u.email) return; if(me.friends && me.friends.includes(u.email)){ alert('Abrindo chat local'); return; } const all = getUsers(); const target = all.find(x=> x.email===u.email); if(!target) return; target.notifications = target.notifications || []; target.notifications.push({ from: me.name, type: 'friend_request', ts: Date.now(), email: me.email }); saveUsers(all); alert('Pedido de amizade enviado'); }); div.appendChild(img); div.appendChild(txt); div.appendChild(btn); out.appendChild(div); }); }); document.getElementById('sendMsg').addEventListener('click', ()=>{ const t = document.getElementById('msgInput').value.trim(); if(!t) return; const arr = JSON.parse(localStorage.getItem('ep_chat')||'[]'); arr.push({ from: me.email, name: me.name, text: t, ts: Date.now() }); localStorage.setItem('ep_chat', JSON.stringify(arr)); document.getElementById('msgInput').value = ''; const box = document.getElementById('chatBox'); box.innerHTML = ''; const a = JSON.parse(localStorage.getItem('ep_chat')||'[]'); a.forEach(m=>{ const el = document.createElement('div'); el.textContent = (m.name?m.name:m.from) + ': ' + m.text; box.appendChild(el); }); }); document.getElementById('logoutBtn').addEventListener('click', ()=>{ localStorage.removeItem('ep_current'); location.href='login.html'; }); });
</script></body></html>
